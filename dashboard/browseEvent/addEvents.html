<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Add Event - UB Lipa Event Scheduler</title>
  <link rel="stylesheet" href="../css/style.css" />
  <style>
    .form-section {
      background-color: white;
      padding: 30px;
      border-radius: 8px;
      max-width: 600px;
      margin: 20px auto;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .form-section h2 {
      font-size: 24px;
      margin-bottom: 20px;
      color: #5b0b1e;
    }

    .event-form {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .event-form input,
    .event-form select,
    .event-form textarea {
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 5px;
      width: 100%;
    }

    .event-form button {
      padding: 12px;
      font-size: 16px;
      background-color: #5b0b1e;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .event-form button:hover {
      background-color: #7a1230;
    }

    .topbar nav .logout-btn {
      margin-left: auto;
      background-color: #fff;
      color: #5b0b1e;
      border: 2px solid #5b0b1e;
      padding: 5px 15px;
      border-radius: 5px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <header class="topbar">
    <div class="logo-title">
      <img src="../../img/ublogo1.png" alt="UB Logo" class="logo" />
      <span class="title">UB Lipa Event Scheduler</span>
    </div>
    <nav>
      <a href="../Home/home.html">Home</a>
      <a href="../browseEvent/browseEvent.html">Browse Events</a>
      <a href="../browseEvent/addEvents.html">Add Events</a>
      <button class="logout-btn" onclick="logoutUser()">Logout</button>
    </nav>
  </header>

  <section class="form-section">
    <h2>Add New Event</h2>
    <form id="eventForm" class="event-form">
      <label>Date:
        <input type="date" name="date" required />
      </label>

      <label>Start Time:
        <input type="time" name="startTime" required />
      </label>

      <label>End Time:
        <input type="time" name="endTime" required />
      </label>

      <label>Event Name:
        <input type="text" name="eventName" required />
      </label>

      <label>Department:
        <select name="department" required>
          <option value="">Select Department</option>
          <option value="CITEC">CITEC</option>
          <option value="CMT">CMT</option>
          <option value="CENAR">CENAR</option>
          <option value="CEAS">CEAS</option>
          <option value="CCJE">CCJE</option>
          <option value="JUNIOR HIGH SCHOOL">JUNIOR HIGH SCHOOL</option>
          <option value="SENIOR HIGH SCHOOL">SENIOR HIGH SCHOOL</option>
        </select>
      </label>

      <label>Location:
        <select name="location" required>
          <option value="">Select Location</option>
          <option value="UB LIPA MULTI-PURPOSE HALL (BUILDING C - 4TH FLOOR)">
            UB LIPA MULTI-PURPOSE HALL (BUILDING C - 4TH FLOOR)
          </option>
          <option value="UB LIPA TIERED LECTURE HALL (BUILDING C - 4TH FLOOR)">
            UB LIPA TIERED LECTURE HALL (BUILDING C - 4TH FLOOR)
          </option>
          <option value="UB LIPA CAFE TRATTORIA (BUILDING C - 2ND FLOOR)">
            UB LIPA CAFE TRATTORIA (BUILDING C - 2ND FLOOR)
          </option>
          <option value="UB LIPA AUDIO VISUAL ROOM (BUILDING A - 3RD FLOOR)">
            UB LIPA AUDIO VISUAL ROOM (BUILDING A - 3RD FLOOR)
          </option>
          <option value="UB LIPA GYMNASIUM">UB LIPA GYMNASIUM</option>
        </select>
      </label>

      <label>Event Type: <input type="text" name="eventType" required /></label>
      <label>Target Audience: <input type="text" name="targetAudience" required /></label>
      <label>Registration Link: <input type="url" name="registrationLink" /></label>
      <label>Contact Information: <input type="text" name="contactInformation" required /></label>
      <label>Agenda: <textarea name="agenda" required></textarea></label>

      <button type="submit">Save Event</button>
    </form>
  </section>

  <footer class="footer">
    <p>Â© UB Lipa Info System</p>
  </footer>

  <script>
    // Submit via JavaScript
    document.getElementById("eventForm").addEventListener("submit", function (e) {
      e.preventDefault();

      const formData = new FormData(this);

      fetch("http://127.0.0.1/IPT_UbEvent/auth/php/addEvent.php", {
        method: "POST",
        body: formData,
      })
        .then((res) => res.text())
        .then((text) => {
          if (text.trim() === "Success") {
            alert("Event added successfully!");
            window.location.href = "../browseEvent/browseEvent.html";
          } else {
            alert(text);
          }
        })
        .catch((err) => {
          console.error("Submission error:", err);
          alert("Error submitting the form.");
        });
    });

    function logoutUser() {
      fetch("http://127.0.0.1/IPT_UbEvent/auth/php/logout.php")
        .then(() => {
          window.location.href = "http://127.0.0.1/IPT_UbEvent/auth/login.html";
        })
        .catch((err) => {
          console.error("Logout failed:", err);
          alert("An error occurred while logging out.");
        });
    }
  </script>
</body>
</html>
