<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <title>UB Lipa Event Scheduler</title>
  <link rel="stylesheet" href="../css/style.css"> <!-- Adjust if needed -->
</head>
<body>

  <!-- HEADER -->
  <header class="topbar">
    <div class="logo-title">
      <img src="/IPT_UBEVENT/img/ublogo1.png" alt="UB Logo" class="logo">
      <span class="title">UB Lipa Event Scheduler</span>
    </div>
    <nav>
      <a href="../Home/home.html">Home</a>
      <a href="../browseEvent/BrowseEvent.html">Browse Events</a>
      <a href="#">Departments</a>
      <a href="#">About</a>
    </nav>
  </header>

  <!-- BROWSE EVENTS SECTION -->
  <section class="browse-events">
    <h2>Browse All Events</h2>

    <!-- FILTERS -->
    <div class="filters">
      <label for="department">üîç Department:</label>
      <select id="department">
        <option value="">‚ñº Select Department</option>
        <option value="College of Engineering">College of Engineering</option>
        <option value="College of Arts and Sciences">College of Arts and Sciences</option>
      </select>

      <label for="date">üìÜ Date:</label>
      <input type="date" id="date">

      <label for="event-type">üéØ Type:</label>
      <select id="event-type">
        <option value="">‚ñº Select Event Type</option>
        <option value="Workshop">Workshop</option>
        <option value="Seminar">Seminar</option>
      </select>

      <button type="button" class="search-btn" id="searchBtn">Search</button>
    </div>

    <!-- EVENT LISTINGS -->
    <h3>Event Listings:</h3>
    <div class="action-buttons">
      <button class="add-event-btn">Add Event</button>
      <button class="import-btn">Import</button>
      <button class="export-btn">Export</button>
    </div>
    <div class="events-table">
      <table border="1" width="100%">
        <thead>
          <tr>
            <th>Date</th>
            <th>Time</th>
            <th>Event Name</th>
            <th>Location</th>
            <th>Department</th>
            <th>Event Type</th>
            <th>Target Audience</th>
            <th>Registration Link</th>
            <th>Agenda</th>
            <th>Contact Information</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="eventsList">
          <!-- Events will load here -->
        </tbody>
      </table>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="footer">
    <p>¬© UB Lipa Static Info System</p>
  </footer>

  <script>
    document.addEventListener("DOMContentLoaded", function() {
      let eventsData = [];
    
      function loadEvents() {
        fetch("../data/events.xml")
          .then(response => response.text())
          .then(str => (new window.DOMParser()).parseFromString(str, "text/xml"))
          .then(data => {
            const events = data.getElementsByTagName("event");
            eventsData = []; 
            for (let i = 0; i < events.length; i++) {
              eventsData.push({
                date: events[i].getElementsByTagName("date")[0]?.textContent || "",
                time: events[i].getElementsByTagName("time")[0]?.textContent || "",
                eventName: events[i].getElementsByTagName("eventName")[0]?.textContent || "",
                location: events[i].getElementsByTagName("location")[0]?.textContent || "",
                department: events[i].getElementsByTagName("department")[0]?.textContent || "",
                eventType: events[i].getElementsByTagName("eventType")[0]?.textContent || "",
                targetAudience: events[i].getElementsByTagName("targetAudience")[0]?.textContent || "",
                registrationLink: events[i].getElementsByTagName("registrationLink")[0]?.textContent || "",
                agenda: events[i].getElementsByTagName("agenda")[0]?.textContent || "",
                contactInformation: events[i].getElementsByTagName("contactInformation")[0]?.textContent || ""
              });
            }
            displayEvents(eventsData);
          })
          .catch(error => console.error(error));
      }
    
      function displayEvents(events) {
        const eventsList = document.getElementById("eventsList");
        eventsList.innerHTML = "";
        events.forEach(event => {
          const row = document.createElement('tr');
    
          row.innerHTML = `
            <td>${event.date}</td>
            <td>${event.time}</td>
            <td>${event.eventName}</td>
            <td>${event.location}</td>
            <td>${event.department}</td>
            <td>${event.eventType}</td>
            <td>${event.targetAudience}</td>
            <td><a href="${event.registrationLink}" target="_blank">Register Here</a></td>
            <td>${event.agenda}</td>
            <td>${event.contactInformation}</td>
            <td><button class="delete-btn">Delete</button></td>
          `;
    
          eventsList.appendChild(row);
        });
    
        // Attach delete buttons after creating rows
        attachDeleteButtons();
      }
    
      function attachDeleteButtons() {
        const deleteButtons = document.querySelectorAll('.delete-btn');
        deleteButtons.forEach(button => {
          button.addEventListener('click', function () {
            if (confirm("Are you sure you want to delete this event?")) {
              this.closest('tr').remove();
            }
          });
        });
      }
      
    
      function applyFilters() {
        const deptFilter = document.getElementById("department").value.toLowerCase();
        const dateFilter = document.getElementById("date").value;
        const typeFilter = document.getElementById("event-type").value.toLowerCase();
    
        const filteredEvents = eventsData.filter(event => {
          const matchDept = deptFilter === "" || event.location.toLowerCase().includes(deptFilter);
          const matchDate = dateFilter === "" || event.date === dateFilter;
          const matchType = typeFilter === "" || event.eventType.toLowerCase().includes(typeFilter);
          return matchDept && matchDate && matchType;
        });
    
        displayEvents(filteredEvents);
      }
    
      document.getElementById("searchBtn").addEventListener("click", applyFilters);
    
      loadEvents(); // Load initially
    });
    </script>
    
</body>
</html>
